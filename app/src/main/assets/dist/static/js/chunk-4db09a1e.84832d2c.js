(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-4db09a1e"],{"3d82":function(t,e,a){"use strict";var s=a("a05e");a.n(s).a},"5c25":function(t,e,a){t.exports=a.p+"static/img/no-data.85975d99.png"},"6ba5":function(t,e,a){"use strict";var s=a("b67f");a.n(s).a},a05e:function(t,e,a){},b67f:function(t,e,a){},caae:function(t,e,i){"use strict";i.r(e);i("8e6e"),i("ac6a"),i("456d"),i("a481");var a,s=i("bd86"),n=(i("2994"),i("2bdd")),o=(i("e7e5"),i("d399")),c=(i("414a"),i("7a82")),l=(i("66b9"),i("b650")),r=(i("e17f"),i("2241")),u=(i("bda7"),i("5e46")),d=(i("da3c"),i("0b33")),h=(i("7f7f"),i("5246"),i("6b41")),v=i("f8b7");function m(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),a.push.apply(a,s)}return a}var f={name:"wallet-detail",components:(a={},Object(s.a)(a,h.a.name,h.a),Object(s.a)(a,d.a.name,d.a),Object(s.a)(a,u.a.name,u.a),Object(s.a)(a,r.a.Component.name,r.a.Component),Object(s.a)(a,l.a.name,l.a),Object(s.a)(a,c.a.name,c.a),Object(s.a)(a,o.a.name,o.a),Object(s.a)(a,n.a.name,n.a),a),computed:{style:function(){return{width:"80px"}},tabsStyle:function(){return this.isIphoneX?"margin: 110px 0px 0px":"margin: 80px 0px 0px"},scrollList:function(){return console.log("this.walletList",this.walletList),this.unique(this.walletList)}},data:function(){return{showNoData:!1,time:216e5,grabTime:36e5,thowFailShow:!1,thowSuccessShow:!1,skuShow:!1,skuSuccessShow:!1,skuDetail:{},walletList:[],loading:!1,finished:!1,error:!1,activeName:1,name:[{title:"已抢单",value:1},{title:"待处理",value:2},{title:"已冻结",value:3}],pageDate:{total:null,pageSize:10,pageNum:1},isIphoneX:!1,thawSkuLoading:!1,confirmSkuLoading:!1}},watch:{activeName:function(t){console.log("val: ",t),this.resetQuery()}},mounted:function(){this.isIphoneX=window.isIphoneX,console.log("2019/12/31 11:17:29",new Date("2019/12/31 11:17:29"),new Date("2019/12/31 11:17:29").getTime())},methods:{unique:function(t){if(Array.isArray(t)){for(var e=[],a=[],s=0;s<t.length;s++)-1===a.indexOf(t[s].id)&&(e.push(t[s]),a.push(t[s].id));return e}console.log("type error!")},resetQuery:function(){this.walletList=[],this.pageDate={total:null,pageSize:5,pageNum:1},this.showNoData=!1,this.loading=!0,this.finished=!1,this.error=!1,this._orderList()},countDownFinish:function(t){t.showTime=!t.showTime},_orderList:function(){var a=this;Object(v.c)({orderType:this.activeName,pageNum:this.pageDate.pageNum,pageSize:this.pageDate.pageSize}).then(function(t){if(console.log("res: ",t),t.success){if(0===t.data.list.length&&0===a.walletList.length)return a.loading=!1,!(a.showNoData=!0);a.pageDate.total=t.data.total||0,a.pageDate.pageNum=a.pageDate.pageNum+1,t.data.list.map(function(t){if(2===a.activeName){var e=t.createTime.replace(/-/g,"/");t.lastTime=12e4<t.localTime-new Date(e).getTime()?0:12e4-(t.localTime-new Date(e).getTime()),t.showTime=t.lastTime<122e3}a.walletList.push(function(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?m(Object(a),!0).forEach(function(t){Object(s.a)(e,t,a[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):m(Object(a)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))})}return e}({},t,{orderType:a.activeName}))})}else o.a.fail(t.message);a.walletList.length>=t.data.total&&(a.finished=!0),a.loading=!1}).catch(function(){a.error=!0})},goBack:function(){this.$router.back()},thawSku:function(s){var i=this;this.thawSkuLoading||(this.thawSkuLoading=!0,console.log("item: ",s),Object(v.e)(s.id).then(function(t){if(console.log("thawSku: ",t),i.thawSkuLoading=!1,t.success)i.thowSuccessShow=!0,i.resetQuery(),i._orderList();else{i.thowFailShow=!0;var e=s.createTime.replace(/-/g,"/"),a=t.data||(new Date).getTime();i.time=216e5<a-new Date(e).getTime()?0:216e5-(a-new Date(e).getTime())}console.log("res: ",t)}).catch(function(){i.thawSkuLoading=!1}))},confirm:function(){var e=this;this.skuShow=!1,this.confirmSkuLoading||(this.confirmSkuLoading=!0,Object(v.b)(this.skuDetail.id).then(function(t){e.confirmSkuLoading=!1,200===t.code?e.skuSuccessShow=!0:o.a.fail(t.message),e.skuShow=!1}).catch(function(){e.confirmSkuLoading=!1}))},grabSku:function(t){this.skuShow=!0,this.skuDetail=t}}},p=(i("3d82"),i("6ba5"),i("2877")),w=Object(p.a)(f,function(){var a=this,t=a.$createElement,s=a._self._c||t;return s("div",[s("van-nav-bar",{attrs:{fixed:""}},[s("div",{staticClass:"header-left",attrs:{slot:"left"},slot:"left"},[s("span",{staticClass:"header-name"},[a._v("记录")])])]),a._v(" "),s("van-tabs",{staticClass:"waller-content",style:a.tabsStyle,attrs:{type:"card",animated:""},model:{value:a.activeName,callback:function(t){a.activeName=t},expression:"activeName"}},a._l(a.name,function(t,e){return s("van-tab",{key:e,staticStyle:{"margin-top":"24px"},attrs:{title:t.title,"title-style":a.style,name:t.value}})}),1),a._v(" "),a.showNoData?s("ul",{staticClass:"wallet-money-list",staticStyle:{width:"100%","text-align":"center","font-size":"16px"}},[s("img",{staticClass:"no-data-img",attrs:{src:i("5c25"),alt:""}}),a._v(" "),s("p",{staticClass:"no-data-text"},[a._v("暂时还没有数据")])]):s("van-list",{staticClass:"record-view",attrs:{finished:a.finished,"finished-text":"没有更多了",error:a.error,"error-text":"请求失败，点击重新加载"},on:{"update:error":function(t){a.error=t},load:a._orderList},model:{value:a.loading,callback:function(t){a.loading=t},expression:"loading"}},[s("ul",{staticClass:"wallet-money-list",staticStyle:{"border-bottom":"1px solid #f5f5f5"}},a._l(a.scrollList,function(e,t){return s("li",{key:t,staticClass:"wallet-money-item"},[s("img",{staticClass:"wallet-money-img",attrs:{src:e.productImg,alt:""}}),a._v(" "),s("div",{staticClass:"wallet-money-content"},[s("p",[a._v(a._s(e.productName))]),a._v(" "),s("p",[a._v("¥"+a._s(e.price))]),a._v(" "),s("p",[a._v(a._s(e.createTime))])]),a._v(" "),1===e.orderType?s("div",{staticClass:"wallet-money-price"},[a._v("返利：¥"+a._s(e.backPrice))]):2===e.orderType?s("div",{staticClass:"wallet-money-price"},[e.showTime?s("div",{staticClass:"wallet-money-grab-sku",on:{click:function(t){return a.grabSku(e)}}},[a._v("确认")]):a._e(),a._v(" "),e.showTime?s("van-count-down",{ref:"countDown",refInFor:!0,attrs:{time:e.lastTime,"auto-start":!0},on:{finish:function(t){return a.countDownFinish(e)}},scopedSlots:a._u([{key:"default",fn:function(t){return[s("span",{staticClass:"time-item"},[a._v(a._s(t.minutes))]),a._v(" "),s("span",{staticClass:"time-item"},[a._v(a._s(t.seconds))])]}}],null,!0)}):a._e()],1):s("div",{staticClass:"wallet-money-price"},[s("div",{staticClass:"wallet-money-thaw-sku",on:{click:function(t){return a.thawSku(e)}}},[a._v("解冻")])])])}),0)]),a._v(" "),s("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1,closeOnClickOverlay:!0},model:{value:a.thowFailShow,callback:function(t){a.thowFailShow=t},expression:"thowFailShow"}},[s("div",{staticClass:"sku-success-detail"},[s("div",{staticClass:"title"},[a._v("解冻失败")]),a._v(" "),s("div",{staticClass:"content",staticStyle:{"text-align":"center",height:"auto"}},[a._v("\n        距离商品解冻还有\n        "),s("van-count-down",{staticStyle:{color:"#FF931F","font-size":"18px",margin:"30px 0 0"},attrs:{time:a.time}})],1)]),a._v(" "),s("div",{staticClass:"sku-btn-group"},[s("van-button",{staticClass:"sku-btn-item",staticStyle:{width:"100%"},attrs:{hairline:"",type:"default"},nativeOn:{click:function(t){a.thowFailShow=!1}}},[a._v("确定")])],1)]),a._v(" "),s("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1,closeOnClickOverlay:!0},model:{value:a.thowSuccessShow,callback:function(t){a.thowSuccessShow=t},expression:"thowSuccessShow"}},[s("div",{staticClass:"sku-success-detail"},[s("div",{staticClass:"title"},[a._v("解冻成功")]),a._v(" "),s("div",{staticClass:"content",staticStyle:{"text-align":"center"}},[a._v("冻结金额已返还至余额")])]),a._v(" "),s("div",{staticClass:"sku-btn-group"},[s("van-button",{staticClass:"sku-btn-item",staticStyle:{width:"100%"},attrs:{hairline:"",type:"default"},nativeOn:{click:function(t){a.thowSuccessShow=!1}}},[a._v("确定")])],1)]),a._v(" "),s("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1},model:{value:a.skuShow,callback:function(t){a.skuShow=t},expression:"skuShow"}},[s("div",{staticClass:"sku-detail"},[s("img",{staticClass:"sku-detail-avatar",attrs:{src:a.skuDetail.productImg,alt:""}}),a._v(" "),s("div",{staticClass:"sku-detail-info"},[s("div",{staticClass:"sku-detail-name"},[a._v(a._s(a.skuDetail.productName))]),a._v(" "),s("div",{staticClass:"sku-detail-price"},[a._v("¥"+a._s(a.skuDetail.productPrice))])])]),a._v(" "),s("div",{staticClass:"sku-btn-group"},[s("van-button",{staticClass:"sku-btn-item",attrs:{plain:"",hairline:"",type:"default"},nativeOn:{click:function(t){a.skuShow=!1}}},[a._v("取消")]),a._v(" "),s("van-button",{staticClass:"sku-btn-item",attrs:{type:"danger"},nativeOn:{click:function(t){return a.confirm(t)}}},[a._v("确定")])],1)]),a._v(" "),s("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1,closeOnClickOverlay:!0},model:{value:a.skuSuccessShow,callback:function(t){a.skuSuccessShow=t},expression:"skuSuccessShow"}},[s("div",{staticClass:"sku-success-detail"},[s("div",{staticClass:"title"},[a._v("抢单成功")]),a._v(" "),s("div",{staticClass:"content"},[s("p",[a._v("商品价值：¥"+a._s(a.skuDetail.productPrice))]),a._v(" "),s("p",[a._v("返利：¥"+a._s(a.skuDetail.backPrice))])])]),a._v(" "),s("div",{staticClass:"sku-btn-group"},[s("van-button",{staticClass:"sku-btn-item",staticStyle:{width:"100%"},attrs:{hairline:"",type:"default"},nativeOn:{click:function(t){a.skuSuccessShow=!1,a.resetQuery(),a._orderList()}}},[a._v("确定")])],1)])],1)},[],!1,null,"119ad48c",null);e.default=w.exports},f8b7:function(t,e,a){"use strict";a.d(e,"a",function(){return i}),a.d(e,"b",function(){return n}),a.d(e,"e",function(){return o}),a.d(e,"c",function(){return c}),a.d(e,"d",function(){return l});var s=a("b775");function i(t){return Object(s.a)({url:"/orderMaster",data:t,method:"post"})}function n(t){return Object(s.a)({url:"/orderMaster/confirm",data:{id:t},method:"put"})}function o(t){return Object(s.a)({url:"/orderMaster/unfreeze",data:{id:t},method:"put"})}function c(t){return Object(s.a)({url:"/orderMaster/page",params:t,method:"get"})}function l(t){return Object(s.a)({url:"/orderMaster/statistics",params:t,method:"get"})}}}]);
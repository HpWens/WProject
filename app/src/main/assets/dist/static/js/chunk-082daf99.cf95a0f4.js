(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-082daf99"],{"0a3c":function(t,e,n){"use strict";n.r(e);var i,a=n("bd86"),s=(n("e7e5"),n("d399")),o=(n("e17f"),n("2241")),c=(n("414a"),n("7a82")),r=(n("66b9"),n("b650")),l=(n("7f7f"),n("5246"),n("6b41")),u=n("f8b7"),d={name:"grab",components:(i={},Object(a.a)(i,l.a.name,l.a),Object(a.a)(i,r.a.name,r.a),Object(a.a)(i,c.a.name,c.a),Object(a.a)(i,o.a.Component.name,o.a.Component),Object(a.a)(i,s.a.name,s.a),i),data:function(){return{showMask:!1,time:5e3,show:!1,skuShow:!1,i:1,grabInfo:{},randomTimes:0,skuDetail:{},skuSuccessShow:!1}},mounted:function(){this._orderStatistics()},methods:{random:function(t,e){return Math.floor(Math.random()*(e-t))+t},_orderStatistics:function(){var e=this;Object(u.d)().then(function(t){console.log("res: ",t),t.success&&(e.grabInfo=t.data,e.randomTimes=e.random(t.data.randomTimes,t.data.randomTimesLimit+1))})},confirm:function(){var e=this;console.log("confirm"),Object(u.b)(this.skuDetail.id).then(function(t){console.log("confirmOrderMaster: ",t),200===t.code?(e.skuDetail.backPrice=t.data.backPrice,e.skuDetail.productPrice=t.data.productPrice,e.skuSuccessShow=!0):(s.a.fail(t.message),e.skuDetail={}),e.skuShow=!1}).catch(function(){})},startGrab:function(){console.log("startGrab"),this.i=1,this.show=!0,this.showMask=!0;try{this.$refs.countDown.reset()}catch(t){}},countDownFinish:function(){var e=this;this.showMask=!1,this.i<this.randomTimes?setTimeout(function(){e.i+=1,e.$refs.countDown.reset()},500):(this.show=!1,Object(u.a)().then(function(t){console.log("res: ",t),200===t.code?(e.skuShow=!0,e.skuDetail=t.data):s.a.fail(t.message),e.randomTimes=e.random(e.grabInfo.randomTimes,e.grabInfo.randomTimesLimit+1)}))},stopGrab:function(){console.log("stopGrab"),this.$refs.countDown.pause(),this.show=!1,this.showMask=!1}},beforeRouteLeave:function(t,e,n){console.log("route"),this.show&&this.showMask||n()}},f=(n("117c"),n("c196"),n("2877")),h=Object(f.a)(d,function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticStyle:{height:"100vh",background:"#f5f5f5"}},[n("van-nav-bar",[n("div",{staticClass:"header-left",attrs:{slot:"left"},slot:"left"},[n("span",{staticClass:"header-name"},[e._v("抢单")])])]),e._v(" "),n("div",{staticClass:"grab-view"},[n("p",[e._v("\n      "+e._s(e.grabInfo.profitPoint)+"%\n      "),n("span",[e._v("佣金")])]),e._v(" "),n("div",{staticClass:"btn-group"},[n("van-button",{staticClass:"btn-grab-item btn-grab-item-red",attrs:{type:"default"},nativeOn:{click:function(t){return e.startGrab(t)}}},[e._v("开始抢单")]),e._v(" "),n("van-button",{staticClass:"btn-grab-item",attrs:{type:"default"},nativeOn:{click:function(t){return e.stopGrab(t)}}},[e._v("停止抢单")])],1)]),e._v(" "),n("div",{staticClass:"grab-info"},[n("div",{staticClass:"grab-info-item"},[n("div",{staticClass:"grab-info-title"},[e._v("今日佣金")]),e._v(" "),n("div",{staticClass:"grab-info-num grab-info-num-red"},[e._v("\n        "+e._s(e.grabInfo.backPrice)+"\n        "),n("span",[e._v("元")])])]),e._v(" "),n("div",{staticClass:"grab-info-item"},[n("div",{staticClass:"grab-info-title"},[e._v("下级返佣")]),e._v(" "),n("div",{staticClass:"grab-info-num grab-info-num-red"},[e._v("\n        "+e._s(e.grabInfo.subBackAmount)+"\n        "),n("span",[e._v("元")])])]),e._v(" "),n("div",{staticClass:"grab-info-item"},[n("div",{staticClass:"grab-info-title"},[e._v("今日单数")]),e._v(" "),n("div",{staticClass:"grab-info-num grab-info-num-orn"},[e._v("\n        "+e._s(e.grabInfo.count)+"\n        "),n("span",[e._v("单")])])]),e._v(" "),n("div",{staticClass:"grab-info-item"},[n("div",{staticClass:"grab-info-title"},[e._v("冻结单数")]),e._v(" "),n("div",{staticClass:"grab-info-num grab-info-num-orn"},[e._v("\n        "+e._s(e.grabInfo.freezeCount)+"\n        "),n("span",[e._v("单")])])]),e._v(" "),n("div",{staticClass:"grab-info-item"},[n("div",{staticClass:"grab-info-title"},[e._v("冻结金额")]),e._v(" "),n("div",{staticClass:"grab-info-num grab-info-num-blue"},[e._v("\n        "+e._s(e.grabInfo.freezePrice)+"\n        "),n("span",[e._v("元")])])])]),e._v(" "),n("van-dialog",{staticClass:"count-down-dialog",attrs:{width:"150px",overlay:!1,"show-cancel-button":!1,"show-confirm-button":!1},model:{value:e.show,callback:function(t){e.show=t},expression:"show"}},[n("van-count-down",{ref:"countDown",attrs:{time:e.time,"auto-start":!0},on:{finish:e.countDownFinish},scopedSlots:e._u([{key:"default",fn:function(t){return[n("span",{staticClass:"count-down-seconds"},[e._v(e._s(t.seconds))])]}}])})],1),e._v(" "),n("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1},model:{value:e.skuShow,callback:function(t){e.skuShow=t},expression:"skuShow"}},[n("div",{staticClass:"sku-detail"},[n("img",{staticClass:"sku-detail-avatar",attrs:{src:e.skuDetail.productImg,alt:""}}),e._v(" "),n("div",{staticClass:"sku-detail-info"},[n("div",{staticClass:"sku-detail-name"},[e._v(e._s(e.skuDetail.productName))]),e._v(" "),n("div",{staticClass:"sku-detail-price"},[e._v("¥"+e._s(e.skuDetail.productPrice))])])]),e._v(" "),n("div",{staticClass:"sku-btn-group"},[n("van-button",{staticClass:"sku-btn-item",attrs:{plain:"",hairline:"",type:"default"},nativeOn:{click:function(t){e.skuShow=!1,e.skuDetail={}}}},[e._v("取消")]),e._v(" "),n("van-button",{staticClass:"sku-btn-item",attrs:{type:"danger"},nativeOn:{click:function(t){return e.confirm(t)}}},[e._v("确定")])],1)]),e._v(" "),n("van-dialog",{staticClass:"sku-dialog",attrs:{"show-cancel-button":!1,"show-confirm-button":!1,closeOnClickOverlay:!0},model:{value:e.skuSuccessShow,callback:function(t){e.skuSuccessShow=t},expression:"skuSuccessShow"}},[n("div",{staticClass:"sku-success-detail"},[n("div",{staticClass:"title"},[e._v("抢单成功")]),e._v(" "),n("div",{staticClass:"content"},[n("p",[e._v("商品价值：¥"+e._s(e.skuDetail.productPrice))]),e._v(" "),n("p",[e._v("返利：¥"+e._s(e.skuDetail.backPrice))])])]),e._v(" "),n("div",{staticClass:"sku-btn-group"},[n("van-button",{staticClass:"sku-btn-item",staticStyle:{width:"100%"},attrs:{hairline:"",type:"default"},nativeOn:{click:function(t){e.skuSuccessShow=!1}}},[e._v("确定")])],1)]),e._v(" "),n("div",{directives:[{name:"show",rawName:"v-show",value:e.showMask,expression:"showMask"}],staticClass:"mask"})],1)},[],!1,null,"4c1a6106",null);e.default=h.exports},"117c":function(t,e,n){"use strict";var i=n("cd1e");n.n(i).a},2241:function(t,e,n){"use strict";var a,s=n("c31d"),o=n("2b0e"),i=n("d282"),h=n("ea8e"),m=n("b1d2"),c=n("6605"),v=n("b650"),r=Object(i.a)("dialog"),l=r[0],b=r[1],g=r[2],u=l({mixins:[c.a],props:{title:String,width:[Number,String],message:String,className:null,callback:Function,beforeClose:Function,messageAlign:String,cancelButtonText:String,cancelButtonColor:String,confirmButtonText:String,confirmButtonColor:String,showCancelButton:Boolean,transition:{type:String,default:"van-dialog-bounce"},showConfirmButton:{type:Boolean,default:!0},overlay:{type:Boolean,default:!0},closeOnClickOverlay:{type:Boolean,default:!1}},data:function(){return{loading:{confirm:!1,cancel:!1}}},methods:{onClickOverlay:function(){this.handleAction("overlay")},handleAction:function(e){var n=this;this.$emit(e),this.value&&(this.beforeClose?(this.loading[e]=!0,this.beforeClose(e,function(t){!1!==t&&n.loading[e]&&n.onClose(e),n.loading.confirm=!1,n.loading.cancel=!1})):this.onClose(e))},onClose:function(t){this.close(),this.callback&&this.callback(t)},onOpened:function(){this.$emit("opened")},onClosed:function(){this.$emit("closed")}},render:function(t){var e,n,i=this,a=t;if(this.shouldRender){var s=this.message,o=this.messageAlign,c=this.slots(),r=this.slots("title")||this.title,l=r&&a("div",{class:b("header",{isolated:!s&&!c})},[r]),u=(c||s)&&a("div",{class:b("content")},[c||a("div",{domProps:{innerHTML:s},class:b("message",((e={"has-title":r})[o]=o,e))})]),d=this.showCancelButton&&this.showConfirmButton,f=a("div",{class:[m.f,b("footer",{buttons:d})]},[this.showCancelButton&&a(v.a,{attrs:{size:"large",loading:this.loading.cancel,text:this.cancelButtonText||g("cancel")},class:b("cancel"),style:{color:this.cancelButtonColor},on:{click:function(){i.handleAction("cancel")}}}),this.showConfirmButton&&a(v.a,{attrs:{size:"large",loading:this.loading.confirm,text:this.confirmButtonText||g("confirm")},class:[b("confirm"),((n={})[m.d]=d,n)],style:{color:this.confirmButtonColor},on:{click:function(){i.handleAction("confirm")}}})]);return a("transition",{attrs:{name:this.transition},on:{afterEnter:this.onOpened,afterLeave:this.onClosed}},[a("div",{directives:[{name:"show",value:this.value}],attrs:{role:"dialog","aria-labelledby":this.title||s},class:[b(),this.className],style:{width:Object(h.a)(this.width)}},[l,u,f])])}}}),d=n("a142");function f(i){return d.d?Promise.resolve():new Promise(function(t,e){var n;a&&(n=a.$el,document.body.contains(n))||(a&&a.$destroy(),(a=new(o.a.extend(u))({el:document.createElement("div"),propsData:{lazyRender:!1}})).$on("input",function(t){a.value=t})),Object(s.a)(a,f.currentOptions,i,{resolve:t,reject:e})})}f.defaultOptions={value:!0,title:"",width:"",message:"",overlay:!0,className:"",lockScroll:!0,transition:"van-dialog-bounce",beforeClose:null,overlayClass:"",overlayStyle:null,messageAlign:"",getContainer:"body",cancelButtonText:"",cancelButtonColor:null,confirmButtonText:"",confirmButtonColor:null,showConfirmButton:!0,showCancelButton:!1,closeOnPopstate:!1,closeOnClickOverlay:!1,callback:function(t){a["confirm"===t?"resolve":"reject"](t)}},(f.alert=f).confirm=function(t){return f(Object(s.a)({showCancelButton:!0},t))},f.close=function(){a&&(a.value=!1)},f.setDefaultOptions=function(t){Object(s.a)(f.currentOptions,t)},f.resetDefaultOptions=function(){f.currentOptions=Object(s.a)({},f.defaultOptions)},f.resetDefaultOptions(),f.install=function(){o.a.use(u)},f.Component=u,o.a.prototype.$dialog=f;e.a=f},"2fcb":function(t,e,n){},"40db":function(t,e,n){},"414a":function(t,e,n){"use strict";n("68ef"),n("40db")},5246:function(t,e,n){"use strict";n("68ef"),n("9d70"),n("09fe"),n("3743"),n("8a0b")},"6b41":function(t,e,n){"use strict";var i=n("2638"),s=n.n(i),a=n("d282"),o=n("a142"),c=n("ba31"),r=n("b1d2"),l=n("ad06"),u=Object(a.a)("nav-bar"),d=u[0],f=u[1];function h(t,e,n,i){var a;return t("div",s()([{class:[f({fixed:e.fixed}),((a={})[r.c]=e.border,a)],style:{zIndex:e.zIndex}},Object(c.b)(i)]),[t("div",{class:f("left"),on:{click:i.listeners["click-left"]||o.e}},[n.left?n.left():[e.leftArrow&&t(l.a,{class:f("arrow"),attrs:{name:"arrow-left"}}),e.leftText&&t("span",{class:f("text")},[e.leftText])]]),t("div",{class:[f("title"),"van-ellipsis"]},[n.title?n.title():e.title]),t("div",{class:f("right"),on:{click:i.listeners["click-right"]||o.e}},[n.right?n.right():e.rightText&&t("span",{class:f("text")},[e.rightText])])])}h.props={title:String,fixed:Boolean,leftText:String,rightText:String,leftArrow:Boolean,border:{type:Boolean,default:!0},zIndex:{type:Number,default:1}},e.a=d(h)},"70e4":function(t,e,n){},"7a82":function(t,e,n){"use strict";var i=n("d282"),a=n("4598"),r=n("68ed");var s=Object(i.a)("count-down"),o=s[0],c=s[1];e.a=o({props:{millisecond:Boolean,time:{type:Number,default:0},format:{type:String,default:"HH:mm:ss"},autoStart:{type:Boolean,default:!0}},data:function(){return{remain:0}},computed:{timeData:function(){return t=this.remain,{days:Math.floor(t/864e5),hours:Math.floor(t%864e5/36e5),minutes:Math.floor(t%36e5/6e4),seconds:Math.floor(t%6e4/1e3),milliseconds:Math.floor(t%1e3)};var t},formattedTime:function(){return function(t,e){var n=e.days,i=e.hours,a=e.minutes,s=e.seconds,o=e.milliseconds;if(-1===t.indexOf("DD")?i+=24*n:t=t.replace("DD",Object(r.b)(n)),-1===t.indexOf("HH")?a+=60*i:t=t.replace("HH",Object(r.b)(i)),-1===t.indexOf("mm")?s+=60*a:t=t.replace("mm",Object(r.b)(a)),-1===t.indexOf("ss")?o+=1e3*s:t=t.replace("ss",Object(r.b)(s)),-1!==t.indexOf("S")){var c=Object(r.b)(o,3);t=-1!==t.indexOf("SSS")?t.replace("SSS",c):-1!==t.indexOf("SS")?t.replace("SS",c.slice(0,2)):t.replace("S",c.charAt(0))}return t}(this.format,this.timeData)}},watch:{time:{immediate:!0,handler:"reset"}},activated:function(){this.keepAlivePaused&&(this.counting=!0,this.keepAlivePaused=!1,this.tick())},deactivated:function(){this.counting&&(this.pause(),this.keepAlivePaused=!0)},beforeDestroy:function(){this.pause()},methods:{start:function(){this.counting||(this.counting=!0,this.endTime=Date.now()+this.remain,this.tick())},pause:function(){this.counting=!1,Object(a.a)(this.rafId)},reset:function(){this.pause(),this.remain=this.time,this.autoStart&&this.start()},tick:function(){this.millisecond?this.microTick():this.macroTick()},microTick:function(){var t=this;this.rafId=Object(a.c)(function(){t.counting&&(t.setRemain(t.getRemain()),0<t.remain&&t.microTick())})},macroTick:function(){var i=this;this.rafId=Object(a.c)(function(){if(i.counting){var t,e,n=i.getRemain();t=n,e=i.remain,Math.floor(t/1e3)===Math.floor(e/1e3)&&0!==n||i.setRemain(n),0<i.remain&&i.macroTick()}})},getRemain:function(){return Math.max(this.endTime-Date.now(),0)},setRemain:function(t){0===(this.remain=t)&&(this.pause(),this.$emit("finish"))}},render:function(t){return t("div",{class:c()},[this.slots("default",this.timeData)||this.formattedTime])}})},"8a0b":function(t,e,n){},c196:function(t,e,n){"use strict";var i=n("70e4");n.n(i).a},cd1e:function(t,e,n){},e17f:function(t,e,n){"use strict";n("68ef"),n("a71a"),n("9d70"),n("09fe"),n("3743"),n("4d75"),n("e3b3"),n("bc1b"),n("2fcb")},f8b7:function(t,e,n){"use strict";n.d(e,"a",function(){return a}),n.d(e,"b",function(){return s}),n.d(e,"e",function(){return o}),n.d(e,"c",function(){return c}),n.d(e,"d",function(){return r});var i=n("b775");function a(t){return Object(i.a)({url:"/orderMaster",data:t,method:"post"})}function s(t){return Object(i.a)({url:"/orderMaster/confirm",data:{id:t},method:"put"})}function o(t){return Object(i.a)({url:"/orderMaster/unfreeze",data:{id:t},method:"put"})}function c(t){return Object(i.a)({url:"/orderMaster/page",params:t,method:"get"})}function r(t){return Object(i.a)({url:"/orderMaster/statistics",params:t,method:"get"})}}}]);
(window.webpackJsonp=window.webpackJsonp||[]).push([["chunk-43dc05ef"],{"0a85":function(e,t,a){"use strict";a.r(t);a("c5f6"),a("34ef"),a("28a5"),a("a481"),a("96cf");var n=a("3b8d"),i=(a("4917"),a("bd86")),s=(a("c3a6"),a("ad06")),r=(a("66b9"),a("b650")),o=(a("68ef"),a("a71a"),a("9d70"),a("3743"),a("09fe"),a("4d75"),a("e3b3"),a("8270"),a("786d"),a("504b"),a("bcd3"),a("c31d")),c=a("d282"),l=a("ea8e"),u=a("a142");function d(e){return Array.isArray(e)?e:[e]}function f(a,n){return new Promise(function(t){if("file"!==n){var e=new FileReader;e.onload=function(e){t(e.target.result)},"dataUrl"===n?e.readAsDataURL(a):"text"===n&&e.readAsText(a)}else t()})}var p=/\.(jpeg|jpg|gif|png|svg|webp|jfif|bmp|dpg)/i;function h(e){return!!e.isImage||(e.file&&e.file.type?0===e.file.type.indexOf("image"):e.url?(t=e.url,p.test(t)):!!e.content&&0===e.content.indexOf("data:image"));var t}var m=a("44bf"),v=a("543e"),g=a("28a2"),b=Object(c.a)("uploader"),y=b[0],w=b[1],_=y({inheritAttrs:!1,model:{prop:"fileList"},props:{disabled:Boolean,uploadText:String,afterRead:Function,beforeRead:Function,beforeDelete:Function,previewSize:[Number,String],name:{type:[Number,String],default:""},accept:{type:String,default:"image/*"},fileList:{type:Array,default:function(){return[]}},maxSize:{type:[Number,String],default:Number.MAX_VALUE},maxCount:{type:[Number,String],default:Number.MAX_VALUE},deletable:{type:Boolean,default:!0},previewImage:{type:Boolean,default:!0},previewFullImage:{type:Boolean,default:!0},imageFit:{type:String,default:"cover"},resultType:{type:String,default:"dataUrl"}},computed:{previewSizeWithUnit:function(){return Object(l.a)(this.previewSize)}},methods:{getDetail:function(e){return void 0===e&&(e=this.fileList.length),{name:this.name,index:e}},onChange:function(e){var t=this,a=e.target.files;if(!this.disabled&&a.length){if(a=1===a.length?a[0]:[].slice.call(a),this.beforeRead){var n=this.beforeRead(a,this.getDetail());if(!n)return void this.resetInput();if(n.then)return void n.then(function(){t.readFile(a)}).catch(this.resetInput)}this.readFile(a)}},readFile:function(a){var e,t,i=this,r=(e=a,t=this.maxSize,d(e).some(function(e){return e.size>t}));if(Array.isArray(a)){var n=this.maxCount-this.fileList.length;a.length>n&&(a=a.slice(0,n)),Promise.all(a.map(function(e){return f(e,i.resultType)})).then(function(n){var e=a.map(function(e,t){var a={file:e,status:""};return n[t]&&(a.content=n[t]),a});i.onAfterRead(e,r)})}else f(a,this.resultType).then(function(e){var t={file:a,status:""};e&&(t.content=e),i.onAfterRead(t,r)})},onAfterRead:function(e,t){this.resetInput(),t?this.$emit("oversize",e,this.getDetail()):(this.$emit("input",[].concat(this.fileList,d(e))),this.afterRead&&this.afterRead(e,this.getDetail()))},onDelete:function(e,t){var a=this;if(this.beforeDelete){var n=this.beforeDelete(e,this.getDetail(t));if(!n)return;if(n.then)return void n.then(function(){a.deleteFile(e,t)}).catch(u.f)}this.deleteFile(e,t)},deleteFile:function(e,t){var a=this.fileList.slice(0);a.splice(t,1),this.$emit("input",a),this.$emit("delete",e,this.getDetail(t))},resetInput:function(){this.$refs.input&&(this.$refs.input.value="")},onPreviewImage:function(e){var t=this;if(this.previewFullImage){var a=this.fileList.filter(function(e){return h(e)}),n=a.map(function(e){return e.content||e.url});this.imagePreview=Object(g.a)({images:n,closeOnPopstate:!0,startPosition:a.indexOf(e),onClose:function(){t.$emit("close-preview")}})}},closeImagePreview:function(){this.imagePreview&&this.imagePreview.close()},genPreviewMask:function(e){var t=this.$createElement,a=e.status;if("uploading"===a||"failed"===a){var n="failed"===a?t(s.a,{attrs:{name:"warning-o"},class:w("mask-icon")}):t(v.a,{class:w("loading")});return t("div",{class:w("mask")},[n,e.message&&t("div",{class:w("mask-message")},[e.message])])}},genPreviewItem:function(t,a){var n=this,e=this.$createElement,i="uploading"!==t.status&&this.deletable&&e(s.a,{attrs:{name:"clear"},class:w("preview-delete"),on:{click:function(e){e.stopPropagation(),n.onDelete(t,a)}}}),r=h(t)?e(m.a,{attrs:{fit:this.imageFit,src:t.content||t.url,width:this.previewSize,height:this.previewSize,radius:4},class:w("preview-image"),on:{click:function(){n.onPreviewImage(t)}}}):e("div",{class:w("file"),style:{width:this.previewSizeWithUnit,height:this.previewSizeWithUnit}},[e(s.a,{class:w("file-icon"),attrs:{name:"description"}}),e("div",{class:[w("file-name"),"van-ellipsis"]},[t.file?t.file.name:t.url])]);return e("div",{class:w("preview"),on:{click:function(){n.$emit("click-preview",t,n.getDetail(a))}}},[r,this.genPreviewMask(t),i])},genPreviewList:function(){if(this.previewImage)return this.fileList.map(this.genPreviewItem)},genUpload:function(){var e=this.$createElement;if(!(this.fileList.length>=this.maxCount)){var t,a=this.slots(),n=e("input",{attrs:Object(o.a)({},this.$attrs,{type:"file",accept:this.accept,disabled:this.disabled}),ref:"input",class:w("input"),on:{change:this.onChange}});if(a)return e("div",{class:w("input-wrapper")},[a,n]);if(this.previewSize){var i=this.previewSizeWithUnit;t={width:i,height:i}}return e("div",{class:w("upload"),style:t},[e(s.a,{attrs:{name:"plus"},class:w("upload-icon")}),this.uploadText&&e("span",{class:w("upload-text")},[this.uploadText]),n])}}},render:function(e){var t=e;return t("div",{class:w()},[t("div",{class:w("wrapper")},[this.genPreviewList(),this.genUpload()])])}}),k=(a("e7e5"),a("d399")),x=(a("bda7"),a("5e46")),C=(a("da3c"),a("0b33")),N=(a("7f7f"),a("5246"),a("6b41")),j=a("b775"),O=a("6821f"),I=a.n(O),D=a("4360");function L(e){var t=new FormData,a=D.a.state.user.user.id;console.log("userId: ",a);var n=I()("taotao".concat(a));return t.append("file",e),t.append("token",n),t.append("userId",a),Object(j.a)({baseURL:"http://192.168.1.97",url:"/file/upload",data:t,method:"post",headers:{"Content-Type":"multipart/form-data"}})}console.log("store: ",D.a);var A,P,R=a("fecf"),E=a("8465"),S=a("c443"),B={name:"wallet-detail",components:(A={},Object(i.a)(A,N.a.name,N.a),Object(i.a)(A,C.a.name,C.a),Object(i.a)(A,x.a.name,x.a),Object(i.a)(A,k.a.name,k.a),Object(i.a)(A,_.name,_),Object(i.a)(A,r.a.name,r.a),Object(i.a)(A,s.a.name,s.a),A),data:function(){return{disabled:!0,fileList:[],form:{price:"",payName:"",payCardNo:""},bankInfo:{},type:"1",message:"Copy These Text",img:"",thumbnail:"",rechargeDayLimit:"",rechargeDayMin:"",fetchLoading:!1}},watch:{activeName:function(e){console.log("val: ",e)}},mounted:function(){this._sysBank(),this._sysParameter();var e;navigator.userAgent.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/)&&(document.body.addEventListener("focusin",function(){clearTimeout(e)}),document.body.addEventListener("focusout",function(){!1||(e=setTimeout(function(){window.scrollTo({top:0,left:0,behavior:"smooth"})},200))}))},methods:{doCopy:function(e){this.$copyText(e).then(function(e){alert("Copied"),console.log(e)},function(e){alert("Can not copy"),console.log(e)})},_sysBank:function(){var t=this;Object(R.e)().then(function(e){console.log("res: ",e),e.success&&(t.bankInfo=e.data)})},_sysParameter:function(){var t=this;Object(S.c)().then(function(e){console.log("res: ",e),e.success&&(t.rechargeDayLimit=e.data.rechargeDayLimit,t.rechargeDayMin=e.data.rechargeDayMin||0)})},throttle:function(e,t){e._id&&clearTimeout(e._id),e._id=window.setTimeout(function(){e(),e._id=null},t)},finished:function(){this.finish()},finish:(P=Object(n.a)(regeneratorRuntime.mark(function e(){var t=this;return regeneratorRuntime.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(this.fetchLoading)return e.abrupt("return");e.next=2;break;case 2:return this.fetchLoading=!0,e.next=5,this.$nextTick();case 5:Object(E.g)({price:this.form.price,payName:this.form.payName,receiveName:this.bankInfo.name,receiveCardNo:this.bankInfo.cardNo,receiveBank:this.bankInfo.bankName,receiveBankBranch:this.bankInfo.branchBank,img:this.img,thumbnail:this.thumbnail}).then(function(e){e.success?(k.a.success("提交充值信息成功"),t.$router.replace("/my-wallet")):(k.a.fail(e.message),t.fetchLoading=!1)}).catch(function(){t.fetchLoading=!1});case 6:case"end":return e.stop()}},e,this)})),function(){return P.apply(this,arguments)}),afterRead:function(e){console.log("afterRead-file: ",e),e.status="uploading",e.message="上传中...";var t=e.file;this.beforeRead(t,e)},compress:function(e){var d=this,t=e,a=new FileReader;a.readAsDataURL(t),a.onload=function(e){var u=new Image;u.src=e.target.result,u.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");console.log("imageWidth: ",100);var a=u.height/u.width*100;console.log("imageHeight: ",a);e.width=100,e.height=a,t.drawImage(u,0,0,100,a);for(var n=e.toDataURL("image/jpeg").split(","),i=n[0].match(/:(.*?);/)[1],r=atob(n[1]),s=r.length,o=new Uint8Array(s);s--;)o[s]=r.charCodeAt(s);var c=(new Date).getTime(),l=new File([o],"".concat(c,".png"),{type:i});console.log("file123567: ",l),L(l).then(function(e){console.log("thumbnail: ",e),d.thumbnail=e.body,console.log("this.thumbnail: ",d.thumbnail)}).catch(function(){})}}},beforeRead:function(e,t){var a=this;if(console.log("file123: ",e),console.log("file-size: ",e.size),5e6<e.size)return Object(k.a)("请上传 5M 大小以内的图片"),t.status="failed",!(t.message="上传失败");try{this.compress(e)}catch(e){console.log("error: ",e)}return console.log("环境变量process.env.VUE_APP_BASE_IMG_BASE_URL","http://192.168.1.97/"),L(e).then(function(e){console.log("res: ",e),a.disabled=!1,a.img=e.body,t.status="done",t.message=""}).catch(function(){t.status="failed",t.message="上传失败",a.img="",k.a.fail("上传失败,请重新上传")}),!0},goBack:function(){this.$router.back()},goDetail:function(){this.$router.push({path:"/rege-detail"})},goNext:function(){var e;return this.form.price?!/^\d+(\.\d{1,2})?$/.test(this.form.price)&&("number"==typeof(e=Number(this.form.price))&&!isNaN(e))||isNaN(this.form.price)?(Object(k.a)("对不起输入金额格式错误"),!1):this.form.price<=0?(Object(k.a)("提现金额必须大于 0"),!1):this.form.payName?this.form.price<this.rechargeDayMin?(k.a.fail("单笔充值最少 ".concat(this.rechargeDayMin," 元")),!1):void(this.type="2"):(k.a.fail("请填写付款人"),!1):(k.a.fail("请填写金额"),!1)},onCopy:function(){console.log(6666),k.a.success("复制成功")},onError:function(){k.a.success("复制失败")},focus:function(){console.log("focus")},blur:function(){console.log("blur"),window.scrollTo({top:0,left:0,behavior:"smooth"})}}},$=(a("3e06"),a("2877")),U=Object($.a)(B,function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("van-nav-bar",{attrs:{title:"钱包充值",fixed:"","left-arrow":""},on:{"click-left":t.goBack,"click-right":t.goDetail}},[a("van-icon",{attrs:{slot:"right",name:"more-o",size:"18"},slot:"right"})],1),t._v(" "),1==t.type?a("div",{staticClass:"recharge-money"},[a("div",{staticClass:"recharge-money-item"},[a("div",{staticClass:"title"},[t._v("充值金额")]),t._v(" "),a("div",{staticClass:"recharge-input"},[a("input",{directives:[{name:"model",rawName:"v-model.number",value:t.form.price,expression:"form.price",modifiers:{number:!0}}],staticClass:"input recharge-num",attrs:{type:"text"},domProps:{value:t.form.price},on:{input:function(e){e.target.composing||t.$set(t.form,"price",t._n(e.target.value))},blur:function(e){return t.$forceUpdate()}}})]),t._v(" "),a("div",{staticClass:"desc"},[t._v("\n        温馨提示：充值请随机附带两位小数，例如100.06实际银行卡转\n        账金额和提交订单的金额必须一致\n      ")]),t._v(" "),a("div",{staticClass:"desc"},[t._v("单笔充值最少 "+t._s(t.rechargeDayMin)+" 元，当日累计充值最高 "+t._s(t.rechargeDayLimit)+" 元")])]),t._v(" "),a("div",{staticClass:"recharge-money-item"},[a("div",{staticClass:"title"},[t._v("付款人")]),t._v(" "),a("input",{directives:[{name:"model",rawName:"v-model",value:t.form.payName,expression:"form.payName"}],staticClass:"input",attrs:{type:"text"},domProps:{value:t.form.payName},on:{focus:t.focus,blur:t.blur,input:function(e){e.target.composing||t.$set(t.form,"payName",e.target.value)}}})]),t._v(" "),a("div",{staticClass:"next-btn",on:{click:t.goNext}},[t._v("下一步")])]):2==t.type?a("div",{staticClass:"recharge-money-upload"},[a("div",{staticClass:"recharge-user-info"},[a("div",{staticClass:"title"},[t._v("收款人信息")]),t._v(" "),a("table",{staticClass:"recharge-user-table",staticStyle:{"border-color":"#E5E5E5"},attrs:{cellspacing:"0",cellpadding:"1",border:"1px"}},[a("tr",[a("td",[t._v("收款人")]),t._v(" "),a("td",[t._v("\n            "+t._s(t.bankInfo.name)+"\n            "),a("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.bankInfo.name,expression:"bankInfo.name",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"recharge-copy-btn"},[t._v("复制")])])]),t._v(" "),a("tr",[a("td",[t._v("银行卡号")]),t._v(" "),a("td",[t._v("\n            "+t._s(t.bankInfo.cardNo)+"\n            "),a("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.bankInfo.cardNo,expression:"bankInfo.cardNo",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"recharge-copy-btn"},[t._v("复制")])])]),t._v(" "),a("tr",[a("td",[t._v("银行")]),t._v(" "),a("td",[t._v("\n            "+t._s(t.bankInfo.bankName)+"\n            "),a("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.bankInfo.bankName,expression:"bankInfo.bankName",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"recharge-copy-btn"},[t._v("复制")])])]),t._v(" "),a("tr",[a("td",[t._v("开户行")]),t._v(" "),a("td",[t._v("\n            "+t._s(t.bankInfo.branchBank)+"\n            "),a("div",{directives:[{name:"clipboard",rawName:"v-clipboard:copy",value:t.bankInfo.branchBank,expression:"bankInfo.branchBank",arg:"copy"},{name:"clipboard",rawName:"v-clipboard:success",value:t.onCopy,expression:"onCopy",arg:"success"},{name:"clipboard",rawName:"v-clipboard:error",value:t.onError,expression:"onError",arg:"error"}],staticClass:"recharge-copy-btn"},[t._v("复制")])])])])]),t._v(" "),a("div",{staticClass:"recharge-pic-upload"},[a("div",{staticClass:"title"},[t._v("上传截图")]),t._v(" "),a("div",{staticClass:"recharge-upload-view"},[a("van-uploader",{attrs:{"after-read":t.afterRead,"max-count":1},on:{delete:function(e){t.disabled=!0}},model:{value:t.fileList,callback:function(e){t.fileList=e},expression:"fileList"}})],1),t._v(" "),a("div",{staticClass:"recharge-desc"},[t._v("＊转账完成后，请务必上传转账截图提交审核")])]),t._v(" "),t.disabled?a("van-button",{staticClass:"next-btn",attrs:{disabled:""}},[t._v("完成")]):a("van-button",{staticClass:"next-btn",on:{click:t.finished}},[t._v("完成")])],1):t._e()],1)},[],!1,null,"841ac6bc",null);t.default=U.exports},"3e06":function(e,t,a){"use strict";var n=a("4fe9");a.n(n).a},"4fe9":function(e,t,a){},8465:function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"i",function(){return o}),a.d(t,"g",function(){return c}),a.d(t,"h",function(){return l}),a.d(t,"e",function(){return u}),a.d(t,"j",function(){return d}),a.d(t,"f",function(){return f}),a.d(t,"c",function(){return p});var n=a("b775");function i(e){return Object(n.a)({url:"/lxbDetail",data:e,method:"post"})}function r(e){return Object(n.a)({url:"/lxbDetail",data:e,method:"put"})}function s(e){return Object(n.a)({url:"/lxbDetail/lxbPage",params:e,method:"get"})}function o(e){return Object(n.a)({url:"/userWithdraw",data:e,method:"post"})}function c(e){return Object(n.a)({url:"/userRecharge",data:e,method:"post"})}function l(){return Object(n.a)({url:"/userWallet/getByUser",method:"get"})}function u(e){return Object(n.a)({url:"/userRecharge/page",params:e,method:"get"})}function d(e){return Object(n.a)({url:"/userWithdraw/page",params:e,method:"get"})}function f(){return Object(n.a)({url:"/sysTimeDepositsSetting/list",method:"get"})}function p(e){return Object(n.a)({url:"/lxbDetail/page",params:e,method:"get"})}},bcd3:function(e,t,a){},c3a6:function(e,t,a){"use strict";a("68ef"),a("9d70"),a("3743")},c443:function(e,t,a){"use strict";a.d(t,"b",function(){return i}),a.d(t,"a",function(){return r}),a.d(t,"c",function(){return s});var n=a("b775");function i(e){return Object(n.a)({url:"/sysMessage/page",params:e,method:"get"})}function r(e){return Object(n.a)({url:"/sysMessage",params:{id:e},method:"get"})}function s(){return Object(n.a)({url:"/sysParameter",params:{},method:"get"})}},fecf:function(e,t,a){"use strict";a.d(t,"a",function(){return i}),a.d(t,"c",function(){return r}),a.d(t,"d",function(){return s}),a.d(t,"b",function(){return o}),a.d(t,"e",function(){return c});var n=a("b775");function i(e){return Object(n.a)({url:"/userBankAccount",data:e,method:"post"})}function r(e){return Object(n.a)({url:"/userBankAccount",data:e,method:"put"})}function s(e){return Object(n.a)({url:"/userBankAccount",params:e,method:"get"})}function o(e){return Object(n.a)({url:"/userBankAccount",params:{id:e},method:"delete"})}function c(){return Object(n.a)({url:"/sysBank",params:{},method:"get"})}}}]);